<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>Risk-Aware Speculation Control</title>
  <meta name="description" content="Master's Thesis Proposal: A Risk-Aware Control Framework for Secure Microarchitecture." />

  <!-- Fonts: Inter & JetBrains Mono -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=JetBrains+Mono:wght@400;500;700&display=swap" rel="stylesheet">

  <!-- KaTeX for Math -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"></script>

  <!-- Mermaid for Diagrams -->
  <script defer src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>

  <!-- Prism for Code Highlighting -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-c.min.js"></script>
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-cpp.min.js"></script>

  <link rel="stylesheet" href="assets/styles.css" />
  <script defer src="assets/app.js"></script>
</head>

<body>
  <div class="layout">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="sidebar__header">
        <div class="brand">ODU<span class="brand__dot">.</span>Frame</div>
        <div class="author">Mohammad Mahdi Razmjoo</div>
        <div class="date">Jan 2026 • M.Sc. Thesis</div>
      </div>
      
      <nav class="nav">
        <a class="nav__item" href="#abstract">01 // Abstract</a>
        <a class="nav__item" href="#logic">02 // Core Logic</a>
        <a class="nav__item" href="#architecture">03 // Architecture</a>
        <a class="nav__item" href="#setup">04 // Exp. Setup</a>
        <a class="nav__item" href="#validation">05 // Validation Code</a>
        <a class="nav__item" href="#plan">06 // Timeline</a>
      </nav>

      <div class="sidebar__footer">
        <a href="#" class="btn btn--ghost">Download PDF</a>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="content">
      <div class="container">
        
        <!-- Hero -->
        <section id="abstract" class="section hero">
          <h1 class="hero__title">A Risk-Aware Control Framework <br> <span class="text-gradient">for Secure Microarchitecture</span></h1>
          <p class="hero__lead">
            Moving from binary "Stop/Go" policies to a probabilistic <strong>Risk/Reward</strong> model. 
            We propose an <strong>Optimal Decision Unit (ODU)</strong> that permits speculation only when the expected utility is positive.
          </p>
          
          <div class="stats-grid">
            <div class="stat-card">
              <span class="stat-card__label">Target</span>
              <span class="stat-card__val">Spectre V1/V2</span>
            </div>
            <div class="stat-card">
              <span class="stat-card__label">Simulator</span>
              <span class="stat-card__val">gem5 (O3)</span>
            </div>
            <div class="stat-card">
              <span class="stat-card__label">Overhead Goal</span>
              <span class="stat-card__val">&lt; 10%</span>
            </div>
          </div>
        </section>

        <!-- Logic -->
        <section id="logic" class="section">
          <div class="section-header">
            <span class="section-num">02</span>
            <h2>The Utility Equation</h2>
          </div>
          
          <p>Current CPUs speculate blindly (High Risk). Static fences kill performance (Low Utility). We introduce a runtime check based on the <strong>Safety Inequality</strong>:</p>

          <div class="math-block">
            \[ \underbrace{\frac{\pi}{1 - \pi}}_{\text{Hardware Odds}} > \underbrace{\frac{\mathcal{L}}{\mathcal{G}}}_{\text{Software Cost}} \]
          </div>

          <div class="grid grid--2">
            <div class="card">
              <h3>Hardware Inputs (Dynamic)</h3>
              <ul class="var-list">
                <li><code class="var">π</code> : <strong>Confidence</strong> (from Branch Predictor).</li>
                <li><code class="var">G</code> : <strong>Gain</strong> (Cycles saved, e.g., Cache Hit/Miss status).</li>
              </ul>
            </div>
            <div class="card">
              <h3>Software Inputs (Static)</h3>
              <ul class="var-list">
                <li><code class="var">L</code> : <strong>Leakage Capacity</strong> (Bits/cycle via Compiler).</li>
                <li><code class="var">Threshold</code> : Tunable policy knob.</li>
              </ul>
            </div>
          </div>
        </section>

        <!-- Architecture -->
        <section id="architecture" class="section">
          <div class="section-header">
            <span class="section-num">03</span>
            <h2>Architecture (ODU)</h2>
          </div>
          <p>
            The <strong>Optimal Decision Unit</strong> sits in the Fetch stage. To avoid latency on the critical path, we avoid division by using Log-Domain Arithmetic and Lookup Tables (LUTs).
          </p>

          <div class="diagram-container">
            <pre class="mermaid">
flowchart LR
    BP[Branch Predictor] -->|Confidence π| ODU
    Cache[Cache Status] -->|Gain G| ODU
    Decode[Instruction Tags] -->|Leakage L| ODU
    
    subgraph ODU [Optimal Decision Unit]
      Logic{"Log(π) - Log(1-π) > Log(L) - Log(G)"}
    end

    ODU -->|Pass| Ex[Execute]
    ODU -->|Fail| Stall[Stall/Clamp]
            </pre>
          </div>
        </section>

        <!-- Setup -->
        <section id="setup" class="section">
          <div class="section-header">
            <span class="section-num">04</span>
            <h2>Experimental Setup</h2>
          </div>
          
          <p>We validate the framework using <strong>gem5</strong> (Cycle-accurate simulator) comparing three baselines.</p>

          <table class="data-table">
            <thead>
              <tr>
                <th>Configuration</th>
                <th>Security</th>
                <th>Performance</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code class="tag tag--red">Unsafe</code></td>
                <td>Vulnerable</td>
                <td>100% (Baseline)</td>
                <td>Standard Out-of-Order execution.</td>
              </tr>
              <tr>
                <td><code class="tag tag--yellow">Fences</code></td>
                <td>Secure</td>
                <td>~60%</td>
                <td><code>LFENCE</code> inserted before every load.</td>
              </tr>
              <tr>
                <td><code class="tag tag--green">ODU (Thesis)</code></td>
                <td>Secure</td>
                <td>Target >90%</td>
                <td>Dynamic clamping based on risk.</td>
              </tr>
            </tbody>
          </table>
        </section>

        <!-- Validation Code -->
        <section id="validation" class="section">
          <div class="section-header">
            <span class="section-num">05</span>
            <h2>Validation Methodology</h2>
          </div>
          <p>
            Following the methodology of <em>Kocher et al. (Spectre)</em> and <em>Lipp et al. (Meltdown)</em>, we utilize a secret-dependent gadget to measure leakage rates.
          </p>

          <!-- Tabbed Code Interface -->
          <div class="code-tabs">
            <div class="tabs-header">
              <button class="tab-btn active" onclick="openTab(event, 'c1')">Victim Gadget (Spectre V1)</button>
              <button class="tab-btn" onclick="openTab(event, 'c2')">gem5 Implementation (C++)</button>
              <button class="tab-btn" onclick="openTab(event, 'c3')">Attack / Measure (C)</button>
            </div>

            <!-- Tab 1: The Victim -->
            <div id="c1" class="tab-content active">
              <pre><code class="language-c">
// The classic Spectre V1 gadget (Listing 1 from paper)
// The ODU must detect the risk here and STALL execution.

void victim_function(size_t x) {
    if (x < array1_size) {
        // ODU Analysis:
        // 1. Branch Predictor: Low Confidence (π) due to mistraining
        // 2. Load array2: High Latency (Cache Miss) -> High Gain (G)
        // 3. Instruction: Dependent Load -> High Leakage (L)
        // RESULT: π*G < (1-π)*L  ==> STALL
        
        temp &= array2[array1[x] * 512];
    }
}
              </code></pre>
            </div>

            <!-- Tab 2: gem5 Implementation -->
            <div id="c2" class="tab-content">
              <pre><code class="language-cpp">
// Pseudocode for ODU logic inside gem5 FetchUnit.cpp

bool FetchUnit::checkRisk(DynInstPtr inst) {
    // 1. Get Hardware Confidence (0.0 to 1.0)
    float pi = branchPred->getConfidence(inst->pc);

    // 2. Get Static Leakage Cost (from ISA extension/Annotation)
    float L = inst->staticInst->getLeakageLevel(); 

    // 3. Estimate Gain (Check if address likely in Cache)
    float G = cache->isLikelyHit(inst->addr) ? LOW_GAIN : HIGH_GAIN;

    // 4. The Inequality (Log Domain)
    // odds = log(pi / (1-pi))
    // cost = log(L / G)
    
    if (LUT_odds[pi] > (LUT_leak[L] - LUT_gain[G])) {
        return true; // Speculate
    } else {
        stats.oduStalls++; // Record metric
        return false; // Stall/Clamp
    }
}
              </code></pre>
            </div>

            <!-- Tab 3: Measurement -->
            <div id="c3" class="tab-content">
              <pre><code class="language-c">
// Measuring Leakage Rate (Based on Spectre Listing 5)
// We run this on gem5. 
// Success = 'results[mix_i]' remains 0 (ODU blocked it).

void measure_leakage() {
    for (i = 0; i < 256; i++) {
        // Flush cache line
        _mm_clflush(&array2[i * 512]);
    }

    // Call Victim (which ODU should protect)
    victim_function(malicious_x);

    // Reload and Time
    for (i = 0; i < 256; i++) {
        time = __rdtscp(&junk);
        junk = array2[i * 512]; 
        delta = __rdtscp(&junk) - time;
        
        if (delta <= CACHE_HIT_THRESHOLD) {
             results[i]++; // LEAK DETECTED
        }
    }
}
              </code></pre>
            </div>
          </div>
        </section>

        <!-- Timeline -->
        <section id="plan" class="section">
          <div class="section-header">
            <span class="section-num">06</span>
            <h2>Timeline</h2>
          </div>
          <div class="timeline">
            <div class="timeline-item">
              <div class="t-date">Weeks 1-2</div>
              <div class="t-content">Base Setup: gem5 + SPEC2017 + Unsafe Baseline.</div>
            </div>
            <div class="timeline-item">
              <div class="t-date">Weeks 3-5</div>
              <div class="t-content"><strong>ODU Implementation:</strong> Inject C++ logic into Fetch Unit.</div>
            </div>
            <div class="timeline-item">
              <div class="t-date">Weeks 6-8</div>
              <div class="t-content"><strong>Security Eval:</strong> Run Spectre Gadgets (RQ1).</div>
            </div>
            <div class="timeline-item">
              <div class="t-date">Weeks 9-10</div>
              <div class="t-content"><strong>Perf Eval:</strong> Run SPEC2017 & Pareto Analysis (RQ2).</div>
            </div>
          </div>
        </section>

      </div>
    </main>
  </div>
</body>
</html>
